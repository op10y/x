System.register(["valtio/vanilla","derive-valtio"],function(E){"use strict";var f,u,p,m,w,j;return{setters:[function(c){f=c.subscribe,u=c.snapshot,p=c.proxy,m=c.ref,w=c.unstable_buildProxyFunction},function(c){j=c.derive,E({derive:c.derive,underive:c.underive,unstable_deriveSubscriptions:c.unstable_deriveSubscriptions})}],execute:function(){E({addComputed:M,devtools:D,proxyMap:z,proxySet:R,proxyWithComputed:I,proxyWithHistory:H,subscribeKey:c,watch:C});function c(a,r,t,e){let s=a[r];return f(a,()=>{const o=a[r];Object.is(s,o)||t(s=o)},e)}let b;function C(a,r){let t=!0;const e=new Set,s=new Map,o=()=>{t&&(t=!1,e.forEach(i=>i()),e.clear(),s.forEach(i=>i()),s.clear())},l=()=>{if(!t)return;e.forEach(d=>d()),e.clear();const i=new Set,v=b;b=e;try{const d=a(n=>(i.add(n),n));d&&e.add(d)}finally{b=v}s.forEach((d,n)=>{i.has(n)?i.delete(n):(s.delete(n),d())}),i.forEach(d=>{const n=f(d,l,r==null?void 0:r.sync);s.set(d,n)})};return b&&b.add(o),l(),o}const x=Symbol();function D(a,r){typeof r=="string"&&(console.warn("string name option is deprecated, use { name }. https://github.com/pmndrs/valtio/pull/400"),r={name:r});const{enabled:t,name:e="",...s}=r||{};let o;try{o=(t!=null?t:!1)&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!o)return;let l=!1;const i=o.connect({name:e,...s}),v=f(a,n=>{const O=n.filter(([h,y])=>y[0]!==x).map(([h,y])=>`${h}:${y.map(String).join(".")}`).join(", ");if(O)if(l)l=!1;else{const h=Object.assign({},u(a));delete h[x],i.send({type:O,updatedAt:new Date().toLocaleString()},h)}}),d=i.subscribe(n=>{var O,h,y,_,P,A;if(n.type==="ACTION"&&n.payload)try{Object.assign(a,JSON.parse(n.payload))}catch(S){console.error(`please dispatch a serializable value that JSON.parse() and proxy() support
`,S)}if(n.type==="DISPATCH"&&n.state){if(((O=n.payload)==null?void 0:O.type)==="JUMP_TO_ACTION"||((h=n.payload)==null?void 0:h.type)==="JUMP_TO_STATE"){l=!0;const S=JSON.parse(n.state);Object.assign(a,S)}a[x]=n}else if(n.type==="DISPATCH"&&((y=n.payload)==null?void 0:y.type)==="COMMIT")i.init(u(a));else if(n.type==="DISPATCH"&&((_=n.payload)==null?void 0:_.type)==="IMPORT_STATE"){const S=(P=n.payload.nextLiftedState)==null?void 0:P.actionsById,U=((A=n.payload.nextLiftedState)==null?void 0:A.computedStates)||[];l=!0,U.forEach(({state:k},N)=>{const L=S[N]||"No action found";Object.assign(a,k),N===0?i.init(u(a)):i.send(L,u(a))})}});return i.init(u(a)),()=>{v(),d==null||d()}}function M(a,r,t=a){const e={};return Object.keys(r).forEach(s=>{e[s]=o=>r[s](o(a))}),j(e,{proxy:t})}function I(a,r){Object.keys(r).forEach(e=>{if(Object.getOwnPropertyDescriptor(a,e))throw new Error("object property already defined");const s=r[e],{get:o,set:l}=typeof s=="function"?{get:s}:s,i={};i.get=()=>o(u(t)),l&&(i.set=v=>l(t,v)),Object.defineProperty(a,e,i)});const t=p(a);return t}const J=a=>typeof a=="object"&&a!==null;let g;const T=a=>{if(g||(g=w()[2]),!J(a)||g.has(a))return a;const r=Array.isArray(a)?[]:Object.create(Object.getPrototypeOf(a));return Reflect.ownKeys(a).forEach(t=>{r[t]=T(a[t])}),r};function H(a,r=!1){const t=p({value:a,history:m({wip:void 0,snapshots:[],index:-1}),clone:T,canUndo:()=>t.history.index>0,undo:()=>{t.canUndo()&&(t.value=t.history.wip=t.clone(t.history.snapshots[--t.history.index]))},canRedo:()=>t.history.index<t.history.snapshots.length-1,redo:()=>{t.canRedo()&&(t.value=t.history.wip=t.clone(t.history.snapshots[++t.history.index]))},saveHistory:()=>{t.history.snapshots.splice(t.history.index+1),t.history.snapshots.push(u(t).value),++t.history.index},subscribe:()=>f(t,e=>{e.every(s=>s[1][0]==="value"&&(s[0]!=="set"||s[2]!==t.history.wip))&&t.saveHistory()})});return t.saveHistory(),r||t.subscribe(),t}function R(a){const r=p({data:Array.from(new Set(a)),has(t){return this.data.indexOf(t)!==-1},add(t){let e=!1;return typeof t=="object"&&t!==null&&(e=this.data.indexOf(p(t))!==-1),this.data.indexOf(t)===-1&&!e&&this.data.push(t),this},delete(t){const e=this.data.indexOf(t);return e===-1?!1:(this.data.splice(e,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},forEach(t){this.data.forEach(e=>{t(e,e,this)})},get[Symbol.toStringTag](){return"Set"},toJSON(){return new Set(this.data)},[Symbol.iterator](){return this.data[Symbol.iterator]()},values(){return this.data.values()},keys(){return this.data.values()},entries(){return new Set(this.data).entries()}});return Object.defineProperties(r,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(r),r}function z(a){const r=p({data:Array.from(a||[]),has(t){return this.data.some(e=>e[0]===t)},set(t,e){const s=this.data.find(o=>o[0]===t);return s?s[1]=e:this.data.push([t,e]),this},get(t){var e;return(e=this.data.find(s=>s[0]===t))==null?void 0:e[1]},delete(t){const e=this.data.findIndex(s=>s[0]===t);return e===-1?!1:(this.data.splice(e,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(t){this.data.forEach(e=>{t(e[1],e[0],this)})},keys(){return this.data.map(t=>t[0]).values()},values(){return this.data.map(t=>t[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(r,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(r),r}}}});
